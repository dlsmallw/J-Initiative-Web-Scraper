<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: frontend/components/views/log-page.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: frontend/components/views/log-page.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>export class LogPageController {
    htmlFilePath = '../src/frontend/components/templates/log.html';  // Filepath to HTML component
    name = 'logs';                  // Page name
    compID = '#log-container';     // Page component container ID

    logLines = []; // Store logs for filtering

    electronAPI = window.electronAPI;
    logger = window.log;

    /**
     * Returns the pages component html filepath.
     * @returns String          The html filepath.
     */
    getHtmlCompPath() {
        return this.htmlFilePath;
    }

    /**
     * Returns the pages name.
     * @returns string          The pages name.
     */
    getName() {
        return this.name;
    }

    /**
     * Returns the pages component container ID.
     * @returns String          The component container ID.
     */
    getCompID() {
        return this.compID;
    }

    /**
     * Generates the navbar name for the specific page.
     * @returns String          The navbar name.
     */
    navbarName() {
        return this.name.charAt(0).toUpperCase() + this.name.slice(1);
    }

    /**
     * Method for intitializing the page in the application.
     */
    initPage() {
        var navLink = $(`&lt;a class="nav-link" id="${this.name}-nav" href="#">${this.navbarName()}&lt;/a>`);
        var navbarItem = $(`&lt;li class="nav-item" id="${this.name}">&lt;/li>`).append(navLink);

        $('#navbar-ul-1').append(navbarItem);

        const insertElement = async () => {
            $('#d_content').append( await $.get(this.htmlFilePath));
        }

        insertElement().then(() => {
            $('#date-filter').val(this.localizeDateValue(new Date()));

            this.loadLogs();
            this.initPageListeners();
            this.logInfo("Log Page Initialized");
        });
    }

    /**
     * Method for initializing the pages event listeners.
     */
    initPageListeners() {
        $('#log-filter').on('change', () => {
            this.displayLogs();
        });

        $('#date-filter').on('change', () => {
            this.displayLogs(); // Reapply filters whenever the date changes
        });

        // Attach clear logs handler
        $('#clearLogsBtn').on('click', () => {
            if (confirm('Are you sure you want to clear all logs?')) {
                this.clearLogs();
            }
        });

        this.logDebug('Log filter and date filter event listeners attached.');

        // Listens for new logs being made and then updates the UI for just that log
        this.logger.logUpdate((data) => {
            this.addLogLine(data);
        });

        this.logger.logsClearedUpdate(() => {
            this.logLines = [];
            this.displayLogs();
        });

        this.logger.logClearError((errRes) => {
            this.postAlert('Failed to clear logs', errRes);
        });
    }


    /**
     * Sets the page active (visible).
     */
    setPageActive() {
        $(`#${this.name}`).addClass('active-nav-item');
        $(this.compID).show();
    }

    /**
     * Sets the page inactive (hidden).
     */
    setPageInactive() {
        $(this.compID).hide();
        $(`#${this.name}`).removeClass('active-nav-item');
    }

    //============================================================================================================================
    // Logging Helpers (WIP - Plan to move to a separate class that is imported)
    //============================================================================================================================

    /**
     * Handles displaying an alert message for specific situations (error or otherwise).
     * @param {*} alertMsg          Message to display.
     * @param {*} cause             Cause if an error.
     */
    postAlert(alertMsg, cause) {
        var json = {
            msg: alertMsg,
            errType: null
        }

        if (cause === undefined) {
            this.electronAPI.postDialog.general(JSON.stringify(json));
            this.logInfo(alertMsg);
        } else {
            json.errType = cause;

            this.electronAPI.postDialog.error(JSON.stringify(json));
            this.logError(`${alertMsg} Cause: ${cause}`);
        }
    }

    /**
     * Send an info log message to the main process.
     * @param {string} message - The message to log.
     */
    logInfo(message) {
        this.logger.info(message);
    }

    /**
     * Send a debug log message to the main process.
     * @param {string} message - The message to log.
     */
    logDebug(message) {
        this.logger.debug(message);
    }

    /**
     * Send a warning log message to the main process.
     * @param {string} message - The message to log.
     */
    logWarn(message) {
        this.logger.warn(message);
    }

    /**
     * Send an error log message to the main process.
     * @param {string} message - The message to log.
     */
    logError(message) {
        this.logger.error(message);
    }

    /**
     * Method for making an IPC log request.
     */
    requestLogs() {
        this.logger.requestLogs();
    }

    //============================================================================================================================
    // Page Specific Methods
    //============================================================================================================================

    /**
     * Takes a date object and converts it into the localized datetime.
     * @param {*} dateObj           The date object.
     * @returns                     The localized date time.
     */
    localizeDateValue(dateObj){
        const local = new Date(dateObj);
        local.setMinutes(dateObj.getMinutes() - dateObj.getTimezoneOffset());
        return local.toJSON().slice(0,10);
    };

    /**
     * Load and display logs.
     */
    async loadLogs() {
        try {
            // Wait for the DOM to be updated
            await new Promise(resolve => setTimeout(resolve, 50));
            const logs = await this.logger.requestLogs();

            this.logDebug('Logs received from main process.');
            if (!logs) {
                this.logWarn('No logs received from main process.');
                return;
            }

            this.logLines = logs;
            this.displayLogs();
        } catch (error) {
            this.logError(`Error loading logs: ${error}`);
        }
    }

    /**
     * Updates the logLines with a new log entry.
     * @param {*} line          The new log.
     */
    addLogLine(logs) {
        if (logs) {
            logs.forEach(logObj => {
                this.logLines.push(logObj);
            });

            this.displayLogs();
        }
    }

    /**
     * Method for appending a new log line into the UI.
     * @param {*} log       The log to be inserted.
     */
    appendLog(log) {
        var $logEntry = $('&lt;div>', {class: "log-entry"});
        $logEntry.text(log);
        $('#log-wrapper').append($logEntry);
    }

    /**
     * Display logs in the UI.
     */
    displayLogs() {
        var typeFilter = $('#log-filter').val();
        var dateFilter = new Date($('#date-filter').val());

        const logOutput = $('#log-wrapper');
        logOutput.empty(); // Clear existing logs

        var logs = this.logLines.filter(logObj => {
            var meetsDateFilter = true ? (dateFilter === undefined || (logObj.logDateTime.toDateString() === dateFilter.toDateString())) : false;
            var meetsTypeFilter = true ? (typeFilter === 'ALL' || logObj.logType === typeFilter) : false;

            if (meetsDateFilter &amp;&amp; meetsTypeFilter) {
                return true;
            }

            return false;
        });

        if (logs.length === 0) {
            // If no logs match, display a message in the log output
            const noLogsMessage = $('&lt;div>', { class: 'no-logs-message text-center text-muted' });
            noLogsMessage.text('No logs found for the selected filters.');
            logOutput.append(noLogsMessage);
        } else {
            logs.forEach(logObj => {
                this.appendLog(logObj.rawLogStr);
            });
        }
        
        if (this.logLines.length > 0) {
            $('#clearLogsBtn').removeAttr('disabled');
        } else {
            $('#clearLogsBtn').prop('disabled', true);
        }
    }

     /**
     * Clear logs both in the UI and on the backend.
     */
    clearLogs() {
        this.logger.clearLogs();
    }
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Sanitizer.html">Sanitizer</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addDataToDatabase">addDataToDatabase</a></li><li><a href="global.html#appendNewScrapedItem">appendNewScrapedItem</a></li><li><a href="global.html#axios">axios</a></li><li><a href="global.html#checkAncestorSelected">checkAncestorSelected</a></li><li><a href="global.html#checkIfAnyActive">checkIfAnyActive</a></li><li><a href="global.html#clearLinkedLSProject">clearLinkedLSProject</a></li><li><a href="global.html#clearLogUpdateInterval">clearLogUpdateInterval</a></li><li><a href="global.html#clearScrapedList">clearScrapedList</a></li><li><a href="global.html#clearTextSelection">clearTextSelection</a></li><li><a href="global.html#closeAllWindows">closeAllWindows</a></li><li><a href="global.html#closeLSWindow">closeLSWindow</a></li><li><a href="global.html#closeScrapeWindow">closeScrapeWindow</a></li><li><a href="global.html#combineSelToResObj">combineSelToResObj</a></li><li><a href="global.html#createLSExternal">createLSExternal</a></li><li><a href="global.html#createMainWindow">createMainWindow</a></li><li><a href="global.html#createURLWindow">createURLWindow</a></li><li><a href="global.html#deselectAllElements">deselectAllElements</a></li><li><a href="global.html#deselectElement">deselectElement</a></li><li><a href="global.html#disableAutoImportBtns">disableAutoImportBtns</a></li><li><a href="global.html#disableManImportBtn">disableManImportBtn</a></li><li><a href="global.html#disableModeSelector">disableModeSelector</a></li><li><a href="global.html#disableWebview">disableWebview</a></li><li><a href="global.html#enableAutoImportBtns">enableAutoImportBtns</a></li><li><a href="global.html#enableManImportBtn">enableManImportBtn</a></li><li><a href="global.html#enableModeSelector">enableModeSelector</a></li><li><a href="global.html#enableWebview">enableWebview</a></li><li><a href="global.html#exportDataToApp">exportDataToApp</a></li><li><a href="global.html#exportDataToLS">exportDataToLS</a></li><li><a href="global.html#formIndivDataResObj">formIndivDataResObj</a></li><li><a href="global.html#formLogObject">formLogObject</a></li><li><a href="global.html#formatDataArr">formatDataArr</a></li><li><a href="global.html#formatProjectData">formatProjectData</a></li><li><a href="global.html#formatTextData">formatTextData</a></li><li><a href="global.html#getAllReadyData">getAllReadyData</a></li><li><a href="global.html#getProjects">getProjects</a></li><li><a href="global.html#getSelectedText">getSelectedText</a></li><li><a href="global.html#hotKeySettingChanging">hotKeySettingChanging</a></li><li><a href="global.html#hotKeySettingNormal">hotKeySettingNormal</a></li><li><a href="global.html#hotkeyChangeRequested">hotkeyChangeRequested</a></li><li><a href="global.html#hoveredElement">hoveredElement</a></li><li><a href="global.html#indivSelToResObj">indivSelToResObj</a></li><li><a href="global.html#initDataContainer">initDataContainer</a></li><li><a href="global.html#initKeyMouseEventListeners">initKeyMouseEventListeners</a></li><li><a href="global.html#initLogListener">initLogListener</a></li><li><a href="global.html#initScrapeUtilListeners">initScrapeUtilListeners</a></li><li><a href="global.html#initScrapeWindow">initScrapeWindow</a></li><li><a href="global.html#initTheme">initTheme</a></li><li><a href="global.html#initWinListeners">initWinListeners</a></li><li><a href="global.html#logDebug">logDebug</a></li><li><a href="global.html#logError">logError</a></li><li><a href="global.html#logInfo">logInfo</a></li><li><a href="global.html#logWarn">logWarn</a></li><li><a href="global.html#makeLog">makeLog</a></li><li><a href="global.html#makeRequestToLS">makeRequestToLS</a></li><li><a href="global.html#manualTextScrape">manualTextScrape</a></li><li><a href="global.html#processSelectedElems">processSelectedElems</a></li><li><a href="global.html#releaseHoveredElement">releaseHoveredElement</a></li><li><a href="global.html#removeSelectedItems">removeSelectedItems</a></li><li><a href="global.html#requestHeader">requestHeader</a></li><li><a href="global.html#requestJSON">requestJSON</a></li><li><a href="global.html#selectElement">selectElement</a></li><li><a href="global.html#selectedElementsCheck">selectedElementsCheck</a></li><li><a href="global.html#selectedTextCheck">selectedTextCheck</a></li><li><a href="global.html#sendNewLogsToRenderer">sendNewLogsToRenderer</a></li><li><a href="global.html#setHotKey">setHotKey</a></li><li><a href="global.html#startLoggingInterval">startLoggingInterval</a></li><li><a href="global.html#terminateApp">terminateApp</a></li><li><a href="global.html#terminateLogListener">terminateLogListener</a></li><li><a href="global.html#updateAPIToken">updateAPIToken</a></li><li><a href="global.html#updateLinkedLSProject">updateLinkedLSProject</a></li><li><a href="global.html#writeNewLog">writeNewLog</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Sat Mar 22 2025 08:06:57 GMT-0700 (Pacific Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
